<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:document xmlns:wpc="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas" xmlns:mo="http://schemas.microsoft.com/office/mac/office/2008/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mv="urn:schemas-microsoft-com:mac:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:wp14="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:w14="http://schemas.microsoft.com/office/word/2010/wordml" xmlns:w15="http://schemas.microsoft.com/office/word/2012/wordml" xmlns:wpg="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup" xmlns:wpi="http://schemas.microsoft.com/office/word/2010/wordprocessingInk" xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml" xmlns:wps="http://schemas.microsoft.com/office/word/2010/wordprocessingShape" mc:Ignorable="w14 w15 wp14"><w:body><w:p w14:paraId="702D383B" w14:textId="77777777" w:rsidR="00E475E4" w:rsidRDefault="00A42461" w:rsidP="00EC65A6"><w:pPr><w:jc w:val="center"/></w:pPr><w:r><w:t>Adjusting the order of the adaptive filter</w:t></w:r></w:p><w:p w14:paraId="11D31916" w14:textId="77777777" w:rsidR="00A42461" w:rsidRDefault="00A42461"/><w:p w14:paraId="6A7618F6" w14:textId="77777777" w:rsidR="00A42461" w:rsidRDefault="00A42461"><w:r><w:t xml:space="preserve">An adaptive filter has </w:t></w:r><w:proofErr w:type="gramStart"/><w:r><w:t>an</w:t></w:r><w:proofErr w:type="gramEnd"/><w:r><w:t xml:space="preserve"> hyper parameter that is user defined: the filter order M. the equation for a FIR filter reads</w:t></w:r></w:p><w:p w14:paraId="4FA88981" w14:textId="77777777" w:rsidR="00A42461" w:rsidRDefault="00A42461"/><w:p w14:paraId="0FB00889" w14:textId="77777777" w:rsidR="00A42461" w:rsidRPr="00A42461" w:rsidRDefault="00A42461"><w:pPr><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr></w:pPr><m:oMathPara><m:oMath><m:acc><m:accPr><m:ctrlPr><w:rPr><w:rFonts w:ascii="Cambria Math" w:hAnsi="Cambria Math"/><w:i/></w:rPr></m:ctrlPr></m:accPr><m:e><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:hAnsi="Cambria Math"/></w:rPr><m:t>y</m:t></m:r></m:e></m:acc><m:d><m:dPr><m:ctrlPr><w:rPr><w:rFonts w:ascii="Cambria Math" w:hAnsi="Cambria Math"/><w:i/></w:rPr></m:ctrlPr></m:dPr><m:e><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:hAnsi="Cambria Math"/></w:rPr><m:t>n</m:t></m:r></m:e></m:d><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:hAnsi="Cambria Math"/></w:rPr><m:t>=</m:t></m:r><m:nary><m:naryPr><m:chr m:val="∑"/><m:limLoc m:val="undOvr"/><m:ctrlPr><w:rPr><w:rFonts w:ascii="Cambria Math" w:hAnsi="Cambria Math"/><w:i/></w:rPr></m:ctrlPr></m:naryPr><m:sub><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:hAnsi="Cambria Math"/></w:rPr><m:t>k=0</m:t></m:r></m:sub><m:sup><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:hAnsi="Cambria Math"/></w:rPr><m:t>M-1</m:t></m:r></m:sup><m:e><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:hAnsi="Cambria Math"/></w:rPr><m:t>w</m:t></m:r><m:d><m:dPr><m:ctrlPr><w:rPr><w:rFonts w:ascii="Cambria Math" w:hAnsi="Cambria Math"/><w:i/></w:rPr></m:ctrlPr></m:dPr><m:e><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:hAnsi="Cambria Math"/></w:rPr><m:t>k</m:t></m:r></m:e></m:d><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:hAnsi="Cambria Math"/></w:rPr><m:t>x(n-k)</m:t></m:r></m:e></m:nary></m:oMath></m:oMathPara></w:p><w:p w14:paraId="6F442E1B" w14:textId="77777777" w:rsidR="00A42461" w:rsidRDefault="00A42461"><w:pPr><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr></w:pPr></w:p><w:p w14:paraId="25A9C6CF" w14:textId="77777777" w:rsidR="00A42461" w:rsidRDefault="00A42461"><w:pPr><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr></w:pPr><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">Since a good order depends upon the structure of the input signal, the data should tell us what is the best order. So we are going to use cross validation to select the best order of the filter (as well as the best regularizing parameter to compute the inverse). Here I will just </w:t></w:r><w:r w:rsidR="00EC65A6"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>discuss in detail</w:t></w:r><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> the filter order</w:t></w:r><w:r w:rsidR="00EC65A6"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> selection, but the procedure is the same for the </w:t></w:r><w:proofErr w:type="spellStart"/><w:r w:rsidR="00EC65A6"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>regulrization</w:t></w:r><w:proofErr w:type="spellEnd"/><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">. </w:t></w:r></w:p><w:p w14:paraId="7D3CB68E" w14:textId="77777777" w:rsidR="00A42461" w:rsidRDefault="00A42461"><w:pPr><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr></w:pPr></w:p><w:p w14:paraId="1D34711B" w14:textId="77777777" w:rsidR="00A42461" w:rsidRDefault="00EC65A6"><w:pPr><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr></w:pPr><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>S</w:t></w:r><w:r w:rsidR="00A42461"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">elect a set of </w:t></w:r><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>5</w:t></w:r><w:r w:rsidR="00A42461"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> filter orders</w:t></w:r><w:r w:rsidR="0096215A"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> values</w:t></w:r><w:r w:rsidR="00A42461"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> between  3 and 30. For each of the filter orders, you will have to compute the </w:t></w:r><w:r w:rsidR="0096215A"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">optimal weights </w:t></w:r><m:oMath><m:sSup><m:sSupPr><m:ctrlPr><w:rPr><w:rFonts w:ascii="Cambria Math" w:eastAsiaTheme="minorEastAsia" w:hAnsi="Cambria Math"/><w:i/></w:rPr></m:ctrlPr></m:sSupPr><m:e><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:eastAsiaTheme="minorEastAsia" w:hAnsi="Cambria Math"/></w:rPr><m:t>W</m:t></m:r></m:e><m:sup><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:eastAsiaTheme="minorEastAsia" w:hAnsi="Cambria Math"/></w:rPr><m:t>*</m:t></m:r></m:sup></m:sSup><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:eastAsiaTheme="minorEastAsia" w:hAnsi="Cambria Math"/></w:rPr><m:t>=</m:t></m:r><m:sSup><m:sSupPr><m:ctrlPr><w:rPr><w:rFonts w:ascii="Cambria Math" w:eastAsiaTheme="minorEastAsia" w:hAnsi="Cambria Math"/><w:i/></w:rPr></m:ctrlPr></m:sSupPr><m:e><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:eastAsiaTheme="minorEastAsia" w:hAnsi="Cambria Math"/></w:rPr><m:t>R</m:t></m:r></m:e><m:sup><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:eastAsiaTheme="minorEastAsia" w:hAnsi="Cambria Math"/></w:rPr><m:t>-1</m:t></m:r></m:sup></m:sSup><m:r><w:rPr><w:rFonts w:ascii="Cambria Math" w:eastAsiaTheme="minorEastAsia" w:hAnsi="Cambria Math"/></w:rPr><m:t>P</m:t></m:r></m:oMath><w:r w:rsidR="0096215A"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>, right</w:t></w:r><w:r w:rsidR="00A42461"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>?</w:t></w:r></w:p><w:p w14:paraId="7FE3D4AC" w14:textId="77777777" w:rsidR="00A42461" w:rsidRDefault="00A42461"><w:pPr><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr></w:pPr></w:p><w:p w14:paraId="6262CFB5" w14:textId="77777777" w:rsidR="0096215A" w:rsidRDefault="0096215A"><w:pPr><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr></w:pPr><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">After computing the </w:t></w:r><w:r w:rsidR="00EC65A6"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">optimal </w:t></w:r><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">filter </w:t></w:r><w:proofErr w:type="gramStart"/><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>weights</w:t></w:r><w:proofErr w:type="gramEnd"/><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> you can compute the output of the filter. So you apply now the validation set to the input and you compute the output, and the cumulative error square for the validation set. </w:t></w:r></w:p><w:p w14:paraId="03C72B19" w14:textId="77777777" w:rsidR="0096215A" w:rsidRDefault="0096215A"><w:pPr><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr></w:pPr></w:p><w:p w14:paraId="0ACD177B" w14:textId="77777777" w:rsidR="00EC65A6" w:rsidRDefault="0096215A"><w:pPr><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr></w:pPr><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">You repeat to the other </w:t></w:r><w:r w:rsidR="00EC65A6"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>4</w:t></w:r><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> values o</w:t></w:r><w:r w:rsidR="00EC65A6"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>f the filter order that you selected</w:t></w:r><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">, and you get </w:t></w:r><w:r w:rsidR="00EC65A6"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>4</w:t></w:r><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> other values for the</w:t></w:r><w:r w:rsidR="00EC65A6"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:proofErr w:type="gramStart"/><w:r w:rsidR="00EC65A6"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">cumulative </w:t></w:r><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> error</w:t></w:r><w:proofErr w:type="gramEnd"/><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">. Then if you plot these </w:t></w:r><w:r w:rsidR="00EC65A6"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>5</w:t></w:r><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> values you can find the order that gives you the SMALLEST J, can’t you. This is the optimal order that you should use to test the filter performance with the two </w:t></w:r><w:r w:rsidR="00EC65A6"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">test set data provided. </w:t></w:r></w:p><w:p w14:paraId="790A8267" w14:textId="77777777" w:rsidR="00EC65A6" w:rsidRDefault="00EC65A6"><w:pPr><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr></w:pPr></w:p><w:p w14:paraId="23399684" w14:textId="77777777" w:rsidR="00A42461" w:rsidRDefault="00EC65A6"><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">The procedure to </w:t></w:r><w:bookmarkStart w:id="0" w:name="_GoBack"/><w:bookmarkEnd w:id="0"/><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>estimate the best optimization parameter is the same (also pick 5 values between 0.001 and 0.1. Since I asked to create a 3D plot, you effectively have to do these test 25 times</w:t></w:r><w:proofErr w:type="gramStart"/><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t>…..</w:t></w:r><w:proofErr w:type="gramEnd"/><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r w:rsidR="0096215A"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve">Then the data will tell you the best values of the two hyper parameters. </w:t></w:r><w:r w:rsidR="00A42461"><w:rPr><w:rFonts w:eastAsiaTheme="minorEastAsia"/></w:rPr><w:t xml:space="preserve"> </w:t></w:r></w:p><w:sectPr w:rsidR="00A42461" w:rsidSect="007F04E5"><w:pgSz w:w="12240" w:h="15840"/><w:pgMar w:top="1440" w:right="1440" w:bottom="1440" w:left="1440" w:header="720" w:footer="720" w:gutter="0"/><w:cols w:space="720"/><w:docGrid w:linePitch="360"/></w:sectPr></w:body></w:document>